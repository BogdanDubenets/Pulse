---
name: clean-chat
description: Правило чистого чату Pulse. Всі сервісні повідомлення бота автовидаляються. Використовуйте при створенні або зміні хендлерів.
---

# Навичка: Чистий чат (Clean Chat UX)

Pulse дотримується принципу **чистого чату** — в історії залишаються тільки:
- ✅ Команди користувача (`/start`, `/channels`, `/help`)
- ✅ Меню і навігація (відповіді на команди)
- ✅ **Дайджести** та цінний контент

Все інше — **тимчасове** і автовидаляється.

## Правила автовидалення

| Тип повідомлення | Видаляти юзера | Видаляти бота | Затримка |
|---|---|---|---|
| Форвард/Share каналу | ✅ 3с | ✅ 5с | — |
| Підтвердження "Канал додано" | — | ✅ 5с | — |
| "Канал вже додано" | ✅ 3с | ✅ 5с | — |
| Помилки ("не канал", "не знайдено") | ✅ 3с | ✅ 5с | — |
| Підказки для невідомого тексту | ✅ 3с | ✅ 5с | — |
| Команди (/start, /help, /add) | ❌ | ❌ | — |
| Навігаційні меню | ❌ | ❌ | — |
| Дайджести | ❌ | ❌ | — |

## Як використовувати

### Імпорт
```python
from bot.utils import schedule_delete
```

### Шаблон для сервісних повідомлень
```python
# Повідомлення бота
bot_msg = await message.answer("✅ Готово!")
schedule_delete(message, 3)       # Повідомлення юзера — 3с
schedule_delete(bot_msg, 5)       # Відповідь бота — 5с
```

### Шаблон для thinking → result
```python
thinking = await message.answer("⏳ Обробляю...")
# ... робота ...
await thinking.edit_text("✅ Готово!")
schedule_delete(message, 3)       # Повідомлення юзера
schedule_delete(thinking, 5)      # Відповідь бота (вже edited)
```

### Шаблон для inline callback (НЕ видаляти)
```python
# Callback query — це навігація, НЕ видаляємо
await callback.message.edit_text("Нове меню", reply_markup=kb)
await callback.answer()
```

## Утиліти (bot/utils.py)
- `schedule_delete(message, delay)` — неблокуюче автовидалення
- `auto_delete(message, delay)` — async корутина видалення

## Важливо
- **НЕ** додавайте inline-кнопки до тимчасових повідомлень (вони зникнуть)
- **НЕ** видаляйте callback-повідомлення (це навігація)
- Завжди обгортайте `schedule_delete` в try/except (вже є в utils.py)
